<idea-plugin>
    <id>io.repogate.plugin</id>
    <name>RepoGate</name>
    <vendor email="support@repogate.io" url="https://repogate.io">RepoGate</vendor>

    <description><![CDATA[
    RepoGate is a security plugin that monitors and validates dependencies before they are added to your project.
    
    Features:
    - Monitors package.json (npm), pom.xml (Maven), and build.gradle (Gradle) for dependency changes
    - Validates dependencies against security vulnerabilities via RepoGate API
    - Blocks installation of unapproved dependencies
    - Provides quick removal of denied dependencies
    - Configurable API token authentication
    ]]></description>

    <change-notes><![CDATA[
    <h3>1.3.0</h3>
    <ul>
      <li>Added support for new /check endpoint status values</li>
      <li>New status: 'scanning' - Package is being scanned for vulnerabilities</li>
      <li>New status: 'not_found' - Package not found, submit request for review</li>
      <li>Improved status messages with icons (‚úì, ‚úó, ‚è≥, üîç, ‚ùì)</li>
      <li>Better handling of all approval workflow states</li>
      <li>Enhanced polling to handle scanning and not_found states</li>
      <li>Verified initial scan runs only once on first install</li>
    </ul>
    <h3>1.2.2</h3>
    <ul>
      <li>CRITICAL: Removed InventoryReporter that was triggering /request for all packages</li>
      <li>Initial scan now ONLY sends to /queue endpoint (no /request calls)</li>
      <li>Fixed duplicate package submission on startup</li>
      <li>Cleaned up unnecessary inventory reporting logic</li>
    </ul>
    <h3>1.2.1</h3>
    <ul>
      <li>Fixed threading issue in InitialPackageScanner causing IDE errors</li>
      <li>Fixed threading issue in InventoryReporter</li>
      <li>Wrapped file index access in ReadAction for proper thread safety</li>
      <li>Added node_modules filtering to prevent scanning dependencies</li>
      <li>Improved error logging and debugging output</li>
    </ul>
    <h3>1.2.0</h3>
    <ul>
      <li>Added initial package scan on first install/enable</li>
      <li>New /queue endpoint integration for existing packages</li>
      <li>Added packageVersion field to dependency requests</li>
      <li>Added projectName field to dependency requests</li>
      <li>Improved version extraction from all package managers</li>
      <li>Scan runs only once per project installation</li>
    </ul>
    <h3>1.1.1</h3>
    <ul>
      <li>Improved connection error handling with graceful retry logic</li>
      <li>Added friendly waiting messages when service is starting</li>
      <li>Automatic retry for up to 5 minutes when service is unavailable</li>
      <li>Clear success notification when connection is established</li>
      <li>Better user experience during service downtime</li>
    </ul>
    <h3>1.1.0</h3>
    <ul>
      <li>Added visual indicators for dependency approval status</li>
      <li>Implemented initial inventory reporting to RepoGate</li>
      <li>Added developer identification in API calls</li>
      <li>Improved notification messages with status icons</li>
      <li>Enhanced company visibility into developer dependency usage</li>
    </ul>
    <h3>1.0.1</h3>
    <ul>
      <li>Updated compatibility for IntelliJ IDEA 2024.3</li>
      <li>Extended support range to build 243.*</li>
    </ul>
    <h3>1.0.0</h3>
    <ul>
      <li>Initial release</li>
      <li>Support for npm, Maven, and Gradle dependency monitoring</li>
      <li>REST API integration for security validation</li>
      <li>Configuration UI for API token</li>
    </ul>
    ]]></change-notes>

    <!-- Product and plugin compatibility requirements -->
    <depends>com.intellij.modules.platform</depends>
    <depends>com.intellij.java</depends>
    <depends optional="true" config-file="repogate-gradle.xml">org.jetbrains.plugins.gradle</depends>
    <depends optional="true" config-file="repogate-maven.xml">org.jetbrains.idea.maven</depends>

    <extensions defaultExtensionNs="com.intellij">
        <!-- Application-level settings -->
        <applicationConfigurable 
            parentId="tools" 
            instance="io.repogate.plugin.settings.RepoGateConfigurable"
            id="io.repogate.plugin.settings.RepoGateConfigurable"
            displayName="RepoGate"/>
        <applicationService 
            serviceImplementation="io.repogate.plugin.settings.RepoGateSettings"/>
        
        <!-- Notification group -->
        <notificationGroup id="RepoGate Notifications" displayType="BALLOON" isLogByDefault="true"/>
    </extensions>

    <projectListeners>
        <listener class="io.repogate.plugin.listeners.DependencyFileListener"
                  topic="com.intellij.openapi.vfs.newvfs.BulkFileListener"/>
    </projectListeners>

    <actions>
        <!-- Add your actions here -->
    </actions>
</idea-plugin>
